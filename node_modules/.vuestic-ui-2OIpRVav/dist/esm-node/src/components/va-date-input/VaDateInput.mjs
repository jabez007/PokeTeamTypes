var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,__defNormalProp=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,__spreadValues=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&__defNormalProp(e,t,a[t]);if(o)for(var t of o(a))n.call(a,t)&&__defNormalProp(e,t,a[t]);return e},__spreadProps=(e,o)=>a(e,t(o));import{defineComponent as l,shallowRef as s,ref as u,toRefs as i,computed as p,watch as d,nextTick as c,resolveComponent as m,openBlock as v,createBlock as f,normalizeClass as y,normalizeStyle as b,withCtx as V,renderSlot as k,normalizeProps as P,guardReactiveProps as g,createVNode as h,mergeProps as D,createSlots as j,createElementVNode as C,toHandlers as I,createCommentVNode as w,withModifiers as x,withKeys as O,renderList as _}from"vue";import{o as $}from"../../../vendor.mjs";import{e as S,a as F,f as B}from"../../utils/child-props.mjs";import{u as W,a as A,b as T}from"../../composables/useClearable.mjs";import"colortranslator";import{u as L,a as E}from"../../composables/useFocus.mjs";import{u as H}from"../../composables/useParsable.mjs";import"../../composables/useDropdown.mjs";import{u as K,b as M}from"../../composables/useStateful.mjs";import{u as U,a as q,b as R}from"../../composables/useValidation.mjs";import{u as z}from"../va-date-picker/hooks/sync-prop.mjs";import{u as N}from"./hooks/range-model-value-guard.mjs";import{u as G}from"./hooks/input-text-parser.mjs";import{i as J,a as Q,b as X}from"../va-date-picker/utils/date-utils.mjs";import{_ as Y}from"../va-date-picker/VaDatePicker.mjs";import{V as Z}from"../va-dropdown/index.mjs";import"../va-input/index.mjs";import{V as ee}from"../va-icon/index.mjs";import{_ as ae}from"../../../plugin-vue_export-helper.mjs";import{V as te}from"../va-dropdown/components/VaDropdownContent/index.mjs";import{V as oe}from"../va-input/components/VaInputWrapper/VaInputWrapper.mjs";const re=S(oe,["focused","maxLength","counterValue","disabled"]),ne=S(Y);var le=ae(l({name:"VaDateInput",components:{VaDropdown:Z,VaDropdownContent:te,VaDatePicker:Y,VaInputWrapper:oe,VaIcon:ee},props:__spreadProps(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},W),re),ne),U),{clearValue:{type:Date,default:void 0},modelValue:{type:[Date,Array,Object,String,Number]},resetOnClose:{type:Boolean,default:!0},isOpen:{type:Boolean,default:void 0},format:{type:Function},formatDate:{type:Function,default:e=>e.toLocaleDateString()},parse:{type:Function},parseDate:{type:Function},parseValue:{type:Function},delimiter:{type:String,default:", "},rangeDelimiter:{type:String,default:" ~ "},manualInput:{type:Boolean,default:!1},color:{type:String,default:"primary"},leftIcon:{type:Boolean,default:!1},icon:{type:String,default:"calendar_today"}}),emits:[...L,...F(Y),...A,...q,...K,"update:is-open","update:text"],inheritAttrs:!1,setup(e,{emit:a,slots:t,attrs:o}){const r=s(),n=u(),{isOpen:l,resetOnClose:m}=i(e),{valueComputed:v}=M(e,a),{syncProp:f}=z(l,"is-open",a,!1),{isFocused:y,focus:b,blur:V,onFocus:k,onBlur:P}=E(r),g=p((()=>!m.value)),{valueComputed:h,reset:D}=N(v,g,e.parseValue);d(f,(e=>{e||g.value||D()}));const dateOrNothing=a=>a?e.formatDate(a):"...",{parseDateInputValue:j,isValid:C}=G(e);d(h,(()=>{C.value=!0}));const modelValueToString=a=>{if(e.format)return e.format(h.value);if(J(a))return a.map((a=>e.formatDate(a))).join(e.delimiter);if(Q(a))return e.formatDate(a);if(X(a))return dateOrNothing(a.start)+e.rangeDelimiter+dateOrNothing(a.end);throw new Error("VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }")},{text:I,value:w}=H(h,j,modelValueToString),x=p((()=>C.value?h.value?I.value:e.clearValue?modelValueToString(e.clearValue):"":"")),reset=()=>{v.value=e.clearValue,a("clear")},focusDatePicker=()=>{c((()=>{var e;return null==(e=n.value)?void 0:e.focusCurrentPicker()}))},focusInputOrPicker=()=>{f.value?focusDatePicker():b()},{computedError:O,computedErrorMessages:_,listeners:S,validationAriaAttributes:F}=R(e,a,reset,b),W=p((()=>!C.value&&h.value!==e.clearValue||O.value)),A=p((()=>{const a=[e.leftIcon&&"prependInner",(!e.leftIcon||e.clearable)&&"icon"];return Object.keys(t).filter((e=>!a.includes(e)))})),{canBeCleared:L,clearIconProps:K,onFocus:U,onBlur:q}=T(e,h),Y=p((()=>e.disabled?{}:e.manualInput?{cursor:"text"}:{cursor:"pointer"})),Z=p((()=>e.disabled||e.readonly?-1:0)),ee=p((()=>({role:"button",ariaHidden:!1,size:"small",name:e.icon,color:e.color,tabindex:Z.value}))),ae=p((()=>__spreadProps(__spreadValues({},B(e,re).value),{focused:y.value,error:W.value,errorMessages:_.value,readonly:e.readonly||!e.manualInput}))),te=p((()=>({focus:()=>{e.disabled||(k(),e.readonly||(U(),S.onFocus()))},blur:()=>{e.disabled||(P(),e.readonly||(q(),S.onBlur()))}}))),oe=p((()=>__spreadValues(__spreadValues({readonly:e.readonly||!e.manualInput,tabindex:e.disabled?-1:0,value:x.value,ariaLabel:e.label||"selected date",ariaRequired:e.requiredMark,ariaDisabled:e.disabled,ariaReadOnly:e.readonly},F.value),$(o,["class","style"]))));return{datePicker:n,valueText:x,valueWithoutText:w,valueComputed:h,isOpenSync:f,onInputTextChanged:({target:e})=>{const a=j(e.value);C.value&&(h.value=a)},isFocused:y,input:r,inputWrapperProps:ae,inputListeners:te,inputAttributesComputed:oe,datePickerProps:B(e,ne),filterSlots:A,canBeCleared:L,clearIconProps:K,iconProps:ee,cursorStyleComputed:Y,hideAndFocus:()=>{f.value=!1,b()},toggleDropdown:a=>{var t;(t=a instanceof KeyboardEvent?a:void 0,f.value||!(e.disabled||e.readonly||e.manualInput&&"Space"!==(null==t?void 0:t.code)))&&(f.value=!f.value,c(focusInputOrPicker))},showDropdown:()=>{e.disabled||e.readonly||(f.value=!0,c(focusDatePicker))},focusInputOrPicker:focusInputOrPicker,focusDatePicker:focusDatePicker,reset:reset,focus:b,blur:V}}}),[["render",function _sfc_render(e,a,t,o,r,n){const l=m("va-icon"),s=m("va-input-wrapper"),u=m("va-date-picker"),i=m("va-dropdown-content"),p=m("va-dropdown");return v(),f(p,{modelValue:e.isOpenSync,"onUpdate:modelValue":a[9]||(a[9]=a=>e.isOpenSync=a),class:y(["va-date-input",e.$attrs.class]),"inner-anchor-selector":".va-input-wrapper__field",style:b(e.$attrs.style),offset:[2,0],"close-on-content-click":!1,stateful:!1,disabled:e.$props.disabled,"keyboard-navigation":"",onOpen:e.focusDatePicker,onClose:e.focus},{anchor:V((()=>[k(e.$slots,"input",P(g({valueText:e.valueText,inputAttributes:e.inputAttributesComputed,inputWrapperProps:e.inputWrapperProps,inputListeners:e.inputListeners})),(()=>[h(s,D({class:"va-date-input__anchor",style:e.cursorStyleComputed},e.inputWrapperProps),j({default:V((()=>[C("input",D({ref:"input",class:"va-date-input__input"},e.inputAttributesComputed,I(e.inputListeners),{onChange:a[0]||(a[0]=(...a)=>e.onInputTextChanged&&e.onInputTextChanged(...a))}),null,16)])),prependInner:V((a=>[k(e.$slots,"prependInner",P(g(a))),e.$props.leftIcon?(v(),f(l,D({key:0,"aria-label":"toggle dropdown"},e.iconProps),null,16)):w("",!0)])),icon:V((()=>[e.canBeCleared?(v(),f(l,D({key:0,"aria-label":"reset date"},__spreadValues(__spreadValues({},e.iconProps),e.clearIconProps),{onClick:x(e.reset,["stop"]),onKeydown:[O(x(e.reset,["stop"]),["enter"]),O(x(e.reset,["stop"]),["space"])]}),null,16,["onClick","onKeydown"])):e.$props.leftIcon?w("",!0):(v(),f(l,D({key:1,"aria-label":"toggle dropdown"},e.iconProps),null,16))])),_:2},[_(e.filterSlots,(a=>({name:a,fn:V((t=>[k(e.$slots,a,P(g(t)))]))})))]),1040,["style"])]))])),default:V((()=>[h(i,{class:"va-date-input__dropdown-content"},{default:V((()=>[h(u,D({ref:"datePicker"},e.datePickerProps,{modelValue:e.valueWithoutText,"onUpdate:modelValue":a[1]||(a[1]=a=>e.valueWithoutText=a),"onClick:day":a[2]||(a[2]=a=>e.$emit("click:day",a)),"onClick:month":a[3]||(a[3]=a=>e.$emit("click:month",a)),"onClick:year":a[4]||(a[4]=a=>e.$emit("click:year",a)),"onHover:day":a[5]||(a[5]=a=>e.$emit("hover:day",a)),"onHover:month":a[6]||(a[6]=a=>e.$emit("hover:month",a)),"onHover:year":a[7]||(a[7]=a=>e.$emit("hover:year",a)),"onUpdate:view":a[8]||(a[8]=a=>e.$emit("update:view",a))}),j({_:2},[_(e.$slots,((a,t)=>({name:t,fn:V((a=>[k(e.$slots,t,P(g(a)))]))})))]),1040,["modelValue"])])),_:3})])),_:3},8,["modelValue","class","style","disabled","onOpen","onClose"])}]]);export{le as _};

import './VaDateInput.css';
//# sourceMappingURL=VaDateInput.mjs.map
